# クーロン力二粒子系の理論解

同質量 `m`、同符号電荷 `q` を持つ 2 粒子が初期距離 `r0` で静止している状況を考える。空間は 1 次元で、重力や接触力は考慮しない。

## 運動方程式（相対座標）

相対距離 `r(t) = x2 - x1` は次の ODE に従う：

```
r''(t) = 2 k q^2 / (m r(t)^2)
```

ここで `k` はクーロン定数。これは各粒子の運動方程式を差し引くことで得られる。

## エネルギー積分

全エネルギー（初期運動エネルギー 0）より

```
E = m (dr/dt)^2 / 4 + k q^2 / r = k q^2 / r0
```

を満たす。よって速度は

```
dr/dt = sqrt( (4 k q^2 / m) * (1/r0 - 1/r) )
```

となる。各粒子の速度は `v = (1/2) dr/dt = sqrt( (k q^2 / m) * (1/r0 - 1/r) )`。

## 時刻と距離の関係

上式を積分すると、単調増加の関数 `t(r)` が得られる：

```
t(r) = tau * [ sqrt(r/r0) * sqrt(r/r0 - 1)
               + log( sqrt(r/r0 - 1) + sqrt(r/r0) ) ]
```

ただし

```
tau = sqrt( (m * r0^3) / (4 k q^2) )
```

である。`t(r)` は解析的に単調なので、数値的な逆関数を求めれば任意の時刻における `r(t)` を取得できる。

## 粒子座標

中心座標は常に 0 なので

```
x1(t) = -0.5 * r(t)
x2(t) =  0.5 * r(t)
```

となる。これらと上記の速度式を比較に用いる。*** End Patch




